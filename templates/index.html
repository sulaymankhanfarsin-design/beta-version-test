<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Slug Generator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <div class="container">
        <h1>URL Slug Generator</h1>
        
        <div class="input-group">
            <label for="text-input">Article Title, Blog Post Title etc.</label>
            <input type="text" id="text-input" placeholder="Enter your text here...">
        </div>
        
        <div class="options-grid">
            <fieldset class="option-group">
                <legend>Separator</legend>
                <div>
                    <input type="radio" id="sep-dash" name="separator" value="-" checked>
                    <label for="sep-dash">Dash (-)</label>
                </div>
                <div>
                    <input type="radio" id="sep-underscore" name="separator" value="_">
                    <label for="sep-underscore">Underscore (_)</label>
                </div>
            </fieldset>

            <fieldset class="option-group">
                <legend>Options</legend>
                <div>
                    <input type="checkbox" id="check-lowercase" checked>
                    <label for="check-lowercase">Lowercase</label>
                </div>
                <div>
                    <input type="checkbox" id="check-special-chars" checked>
                    <label for="check-special-chars">Remove Special Characters</label>
                </div>
                <div>
                    <input type="checkbox" id="check-remove-numbers">
                    <label for="check-remove-numbers">Remove Numbers</label>
                </div>
            </fieldset>
        </div>

        <div class="input-group">
            <label for="slug-output">Slug will be shown here automatically...</label>
            <div class="output-wrapper">
                <input type="text" id="slug-output" readonly>
                <button id="copy-button">Copy</button>
            </div>
        </div>

    </div>

    <script>
        // Get references to all our HTML elements
        const textInput = document.getElementById('text-input');
        const slugOutput = document.getElementById('slug-output');
        const copyButton = document.getElementById('copy-button');

        // --- This is the main function ---
        async function generateSlug() {
            // 1. Get all the current values from the form
            const text = textInput.value;
            const separator = document.querySelector('input[name="separator"]:checked').value;
            const removeNumbers = document.getElementById('check-remove-numbers').checked;
            const lowercase = document.getElementById('check-lowercase').checked; // NEW
            
            // NOTE: 'remove-special-chars' is the main job of slugify.
            // We pass the value, but the library always does this.
            const removeSpecial = document.getElementById('check-special-chars').checked; // NEW

            // 2. Send this data to our Python (Flask) back-end
            const response = await fetch('/generate-slug', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    'text': text,
                    'separator': separator,
                    'remove_numbers': removeNumbers,
                    'lowercase': lowercase, // NEW
                    'remove_special': removeSpecial // NEW
                }),
            });

            // 3. Get the JSON response back from Python
            const data = await response.json();

            // 4. Update the output box with the slug
            slugOutput.value = data.slug;
        }

        // --- Event Listeners ---
        // Run the function whenever the user types or clicks an option
        textInput.addEventListener('input', generateSlug);
        document.querySelectorAll('input[name="separator"]').forEach(radio => {
            radio.addEventListener('change', generateSlug);
        });
        document.getElementById('check-remove-numbers').addEventListener('change', generateSlug);

        // ADD THESE NEW LISTENERS:
        document.getElementById('check-lowercase').addEventListener('change', generateSlug);
        document.getElementById('check-special-chars').addEventListener('change', generateSlug);

        // Add functionality to the "Copy" button
        copyButton.addEventListener('click', () => {
            slugOutput.select(); // Select the text
            navigator.clipboard.writeText(slugOutput.value);
            
            // Give user feedback
            copyButton.textContent = 'Copied!';
            setTimeout(() => {
                copyButton.textContent = 'Copy';
            }, 1500);
        });
    </script>

</body>
</html>